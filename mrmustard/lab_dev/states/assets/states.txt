<%! 
from mrmustard.physics.representations import Bargmann, Fock
from mrmustard.lab_dev.states import Ket, DM
%>

<div style="display: flex; flex-direction: column; max-width=800px">
    <div style="flex: 1">
        <h1>${state.name or state.__class__.__name__}</h1>

        <table style="border-collapse: collapse; text-align: center;">
            <tr>
                <th>Purity</th>
                <th>Probability</th>
                <th>Number of modes</th>
                <th>Class</th>
                <th>Bargmann</th>
                <th>Fock</th>
            </tr>

            <tr>
                <td>${f"{state.purity}" if state.purity == 1 else f"{state.purity :.2e}"}</td>
                <td>${f"{100*state.probability:.3e} %" if state.probability < 0.001 else f"{state.probability:.3%}"}</td></td>
                <td>${state.n_modes}</td></td>
                <td>${"Ket" if isinstance(state, Ket) else "DM"}</td></td>
                <td>${"✅" if isinstance(state.representation, Bargmann) else "❌"}</td></td>
                <td>${"✅" if isinstance(state.representation, Fock) else "❌"}</td>
            </tr>
        </table>
    </div> 

    % if state.n_modes == 1:
    <div style="display: flex; flex: 0 0 auto; flex-wrap: wrap; column-gap: 10px; ">
        <div style="flex: 0 0 auto;">
            ${state.visualize_dm().to_html()}
        </div>
        <div style="flex: 0 0 auto;">
            ${state.visualize_2d().to_html()}
        </div>
    </div>
    % endif  
</div>